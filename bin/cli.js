#!/usr/bin/env node
(()=>{var e={120:e=>{function o(e){var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}o.keys=()=>[],o.resolve=o,o.id=120,e.exports=o},317:e=>{"use strict";e.exports=require("child_process")},330:e=>{"use strict";e.exports=JSON.parse('{"name":"@maloulab/cli","version":"1.0.3","scripts":{"test":"echo \\"Error: no test specified\\" && exit 1","build":"webpack --config webpack.config.js","prepublishOnly":"npm version patch"},"keywords":["maloulab","maloulab/cli","@maloulab/cli","weapp"],"bin":{"malou":"./bin/cli.js"},"files":["bin","README.md","package.json"],"publishConfig":{"registry":"https://registry.npmjs.org/"},"author":"savior","license":"ISC","description":"","dependencies":{},"devDependencies":{"webpack-cli":"^5.1.4","@types/node":"^22.9.0","ts-loader":"^9.5.1","typescript":"^5.6.3","webpack":"5","webpack-shell-plugin-next":"^2.3.2"}}')}},o={};function s(r){var t=o[r];if(void 0!==t)return t.exports;var c=o[r]={exports:{}};return e[r](c,c.exports,s),c.exports}s.o=(e,o)=>Object.prototype.hasOwnProperty.call(e,o),(()=>{"use strict";const e={defaultMacWxevToolsPath:"/Applications/wechatwebdevtools.app/Contents/MacOS/cli",defaultWinWxevToolsPath:"C:/Program Files (x86)/Tencent/微信web开发者工具/cli.bat",defaultFileName:"dist",successColor:"[32m%s[0m",logPrefix:"malou",fileAfterfix:["js","json"]},{exec:o}=s(317),r=require("fs"),t=require("path"),{defaultWinWxevToolsPath:c,defaultMacWxevToolsPath:l,fileAfterfix:a,defaultFileName:i,logPrefix:n}=e,p="win32"===process.platform?c:l,u=".malou.config",{version:d}=s(330),f=process.argv.slice(2)[0];if("open:weapp"===f){const{devToolsPath:c,filePath:l,appId:d}=function(){const e=t.resolve(process.cwd(),u),o={appId:"",devToolsPath:p,filePath:t.resolve(process.cwd(),i)},c=a.every((e=>!r.existsSync(t.resolve(process.cwd(),`${u}.${e}`))));if(console.log("-------.malou.config配置读取中----------"),!c)return console.log("未发现.malou.config配置文件，使用默认配置"),o;try{const o=r.readFileSync(e,"utf-8");console.log("读取完成，正在打开");let c={};(function(e){try{return JSON.parse(e),!0}catch(e){return!1}})(o)&&(c=JSON.parse(o)),c=s(120)(e);let l=c?.devToolsPath||p,a=c?.appId||"";const n=c?.appId||i;return{appId:a,devToolsPath:l,filePath:c?.filePath||t.resolve(process.cwd(),n)}}catch(e){return console.log(`${n}: 读取${u} 文件报错:", error`),o}}();!function({wechatDevToolsPath:s,projectPath:r,appId:t}){let c=`${s} open --project ${r}`;t&&(c+=` --appId ${t}`),o(c,((o,c,l)=>{o?console.error(`${e.logPrefix}: 打开失败: ${o}`):(console.log(e.successColor,`${e.logPrefix}: success, appId：${t}`),console.log(e.successColor,`${e.logPrefix}: success, wechatDevToolsPath：${s}`),console.log(e.successColor,`${e.logPrefix}: success, projectPath${r}`))}))}({wechatDevToolsPath:c||"",projectPath:l||"",appId:d})}"--version"!==f&&"-v"!==f||(console.log(`v${d}`),process.exit(0))})()})();